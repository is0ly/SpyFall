<html>
	<body>
		<p>
			<button>Декодировать</button>
		</p>
		<canvas id="source" width="600" height="400"></canvas>
		<canvas id="message" width="600" height="400"></canvas>
		<canvas id="solver" width="600" height="400"></canvas>

		<script src="./data.js"></script>
		<script src="./functions.js"></script>
		<script>
			const width = 6;
			const height = 4;
			const key = getEncryptionKey();
			console.log("Ключ шифрования", key);

			document.querySelector("button").addEventListener("click", () => {
				let pixelRArray = [];
				let pixelGArray = [];
				let pixelBArray = [];
				let secretPixel;
				let SecretPixelArray = [];
				for (let x = 0; x < width; x++) {
					for (let y = 0; y < height; y++) {
						// console.log("x", x);
						// console.log("y", y);
						// Получение пикселя оригинального сообщения
						const originalPixel = getOriginalPixelColor(x, y);
						// Получение пикселя зашифрованного сообщения
						const secretPixel = getMessagePixelColor(x, y);

						// pixelRArray.push(pixelr);
						// pixelGArray.push(pixelg);
						// pixelBArray.push(pixelb);

						// ABC'.charCodeAt(0)

						// console.log(pixelr);

						let binaryR = (
							secretPixel.r - originalPixel.r
						).toString(2);
						let binaryG = (
							secretPixel.g - originalPixel.g
						).toString(2);
						let binaryB = (
							secretPixel.b - originalPixel.b
						).toString(2);

						// console.log("BinR", binaryR);
						// console.log("BinG", binaryG);
						// console.log("BinB", binaryB);

						

						// console.log(SecretPixelArray);

						let digit = parseInt(binaryR + binaryG + binaryB, 2);

                    secretPixelArray.push(digit);

                    console.log(secretPixelArray);

						for (let index = 0; index < digit.length - 1; index++) {
							// digit = key.charCodeAt(i % key.length);
							console.log("Here!");
						}

						console.log(digit.length);

						// console.log(digit);
						// let digitG = parseInt(binaryG, 2);
						// let digitB = parseInt(binaryB, 2);

						// console.log(digitR);
						// console.log(digitG);
						// console.log(digitB);
						originalPixel.r = digit;
						originalPixel.g = digit;
						originalPixel.b = digit;

						putPixelToSolution(originalPixel, x, y);
					}
				}
				// console.log("R", pixelRArray);
				// console.log("G", pixelGArray);
				// console.log("B", pixelBArray);
			});
		</script>
	</body>
</html>
